---
title: ranger 官方文档
tag:
  - ranger
date: 2024-02-03
openCategory: false
---

## 用户界面

ranger 的主要窗口默认由三个面板组成（顺便说一句，这被称为 [Miller columns](https://en.wikipedia.org/wiki/Miller_columns)）：

中间的负责展示当前目录，左侧负责展示父目录，当前目录被高亮，右侧的负责展示子目录内容或者对内容进行预览

如果你很熟悉 vim，你应该会对 ranger 的 UI 操作感到熟悉。ranger 使用 `hjkl` 键进行导航，并且从 vim 借鉴了许多习惯。例如: `yy` (在 vim 中复制行) 复制文件，`pp` 粘贴文件，`dd` 剪切文件。更复杂的功能可以通过 `:` (冒号) 调用命令行来调用。

当前文件的属性可以在底部看到，当前目录的路径可以在顶部看到。

`:`(冒号) 打开 ranger 的控制台 - 在这里你可以手动运行命令。

<img src='https://raw.githubusercontent.com/shellRaining/img/main/2402/ranger_UI.png'>

## 基本操作

基本的移动操作借鉴了 vim

- `j`/`k` 上下移动，
- `l` 进入选中的目录或者打开文件，
- `h` 返回上级目录

更多有用的键位

- `i` 查看文件或者退出查看文件。查看文件意味着全屏显示当前文件的预览，可以滚动查看。
- `q` 退出。你可以使用这个键关闭当前标签，如果是最后一个标签，则关闭 ranger

## 键位绑定和提示

有很多的命令都被绑定了键位，你可以通过提示找到正确的映射。

命令提示会在映射有多个选项的时候出现:

- `g` 导航和标签
- `r` 打开文件
- `y` 复制
- `d` 剪切
- `p` 粘贴
- `o` 排序
- `.` 过滤
- `z` 更改设置
- `u` 撤销
- `M` 行模式
- `+`，`-`，`=` 设置文件的访问权限

## 配置

ranger 使用四个主要的配置文件

- `rc.conf` 用于设置各种选项和绑定键到函数
- `rifle.conf` 决定打开文件的程序
- `scope.sh` 是一个用于生成各种文件类型预览的 shell 脚本
- `commands.py` 包含了各种函数的实现，使用 python 编写，用于修改 ranger 的行为，并实现自己的 [[Custom Commands|自定义命令]]

使用 `ranger --copy-config=rc` 或者 `rifle`，`scope`，`commands` 来复制默认的配置文件到 `~/.config/ranger` 并在那里修改它们

请注意，对于 `rc.conf` 和 `commands.py`，ranger 会读取 *全局* 和 *用户* 配置文件(按照这个顺序)。这允许用户只维护一个小的配置文件，只设置默认配置文件中没有设置的东西。对于 `scope.sh` 和 `rifle.conf`，ranger 只会读取 *用户* 或者 *全局* 配置文件。

最好的做法是只在 `rc.conf` 中添加你想要改变的选项/绑定键，而不是拷贝默认的 `rc.conf`。这样可以避免手动更新你的配置文件，并且可以获得未来 ranger 版本的新选项/绑定键。

### 运行时更改配置

你可以在不编辑配置文件的情况下更改一些 ranger 的设置。这些更改只在当前的 ranger 会话中有效。要做到这一点，按下 `z` 键并使用命令提示。例如，`zh` 切换显示/隐藏隐藏文件。

## 预览

ranger 可以预览许多文件类型，包括文本文件，图像，视频，PDF，等等。预览的文件类型和预览的方式都可以通过 `scope.sh` 配置文件来设置。`scope.sh` 是一个普通的 shell 脚本，它的行为在注释中有详细的文档。

请注意，可以用其他语言或者编译的二进制文件替换 `scope.sh`。它只需要遵循 `scope.sh` 的调用约定和返回代码。

### 图像预览

ranger 可以在终端中显示图像。它使用 `w3m` 浏览器附带的一个工具(有时会打包在一个单独的包中，如 Debian 中的 `w3m-img`)。虽然它在大多数情况下是可靠的，但请注意它是一个 hack，有时可能表现得非常奇怪。

ranger 在一些支持它的终端中可靠地显示图像，如 Kitty。要启用它，打开你的 `rc.conf` 文件，并将 `preview_images_method` 设置为 kitty，具体取决于你的终端。

为了切换图像的预览，使用 `zi`。更多关于图像预览的信息请看[这里](https://github.com/ranger/ranger/wiki/Official-User-Guide#custom-image-previews)

## 标签页，书签，跳转 (Tabs, Bookmarks, Traveling)

Tabs 和/或者 Bookmarks 用于快速访问一些目录。你也可以使用 `:travel` 命令来浏览目录。ranger 也有一些导航快捷键的命令提示。按 `g` 来调用它。

### 标签页

ranger 支持多标签。你可以为每个目录创建一个标签，以便快速访问。标签是有编号的。要切换到第 N 个标签，按 `Alt-N`，其中 `N` 是标签号。如果这样的标签还不存在，它将被创建。你也可以使用 `Tab` 和 `shift-Tab` 键在标签之间切换。要关闭一个标签，按 `q` (如果你关闭了最后一个标签，整个 ranger 进程将关闭)。

::: info
设置 tabs 的目录是父目录，而不是第二栏的当前目录
:::

### 书签

一个 bookmark 就是快速访问目录的字符。你可以使用 `m<key>` 来标记当前目录，然后在任何其他地方使用 `'<key>` 来快速访问它。使用 `''` 来返回。ranger 默认保存你的书签。

### 跳转

如果你想要快速访问一个目录，但它不在你的书签中，你可以使用 `:travel` 命令。只需在 ranger 控制台中输入 `:travel` 然后输入目录的第一个字母。ranger 会在当前目录中查找匹配的目录和文件，并在唯一时自动进入它，等待另一个目录或文件的名字。所以，你可以通过部分输入它们的名字来浏览多层嵌套的目录。

::: warning
暂时还不会使用这个功能，感觉比较鸡肋
:::

## 选择，宏，标记 (Selection, Macros, Tags)

`Selection` 和 `Macros` 用于指定文件，在 ranger 中执行命令。命令默认在选择的文件上执行，但你可以使用宏指定其他文件。你也可以使用 `:mark_tag` 来选择所有被打上 `Tags` 的文件。

### 选择

ranger 命令大多作用于选择的文件。如果有选择的文件，那么选择就是所有标记的文件，否则就是当前文件。

你可以使用 `space` 键来标记当前文件，`v` 键来反转选择，`V` 键进入可视模式，你可以使用移动或者搜索来标记一系列文件。使用 `:mark REGEX` 和 `:unmark REGEX` 来标记/取消标记匹配正则表达式的文件。使用 `:mark_tag TAG` 和 `:unmark_tag TAG` 来标记/取消标记标签的文件。使用 `:unmark` 或者 `uv` 来取消标记所有标记的文件。

一个黄色的 __Mrk__ 标记会在右下角显示，来表示这个文件或者目录被打上了标记

### 宏

如果你在 ranger 控制台中输入命令，你可以使用下面的宏来缩写:

- `%f` 当前高亮的文件
- `%d` 当前目录的路径
- `%s` 当前目录中选中的文件
- `%t` 当前目录中所有被打上标签的文件
- `%c` 当前复制/剪切文件的完整路径
- `%p` 当前选中文件的完整路径

假如你有一些被选中的文件，但是你只想在单个文件上运行 `:delete` 命令。如果你只运行 `:delete` 命令，它会删除你选择的所有文件，因为命令默认在选择上运行。所以你需要高亮你想要删除的文件，然后在控制台中输入下面的命令，`:delete %f`。

### 标记

`Tags` 是单个字符，它们显示在文件名的左边。按 `t` 键可以设置默认的标签(默认是 `*`) 或者取消文件的标签。要从选择中删除标签，使用 `ut`。你不仅仅局限于默认的标签。按引号 `"` 键，然后输入任何其他字符，就可以将这个字符设置为文件的标签。标签是持久的，直到你手动删除它们。它可以用于标记你已经阅读过的电子书或者需要一些操作的文件。

标签也可以用于自动启用某些目录中的选项。参考 `:setintag` 命令的文档。

## 筛选，排序，扁平化目录 (filter, sort, flatten)

如果当前目录中有太多的文件，你可以使用过滤器(`zf` 或者 `zz`)来只显示匹配你的正则表达式的文件。运行 `:filter REGEX` 来只显示匹配 REGEX 的文件，运行 `:filter` 来重置过滤器。

ranger 也有 `:filter_stack` 功能，键 `.`。你可以将过滤器添加到堆栈中，包括二进制运算符。默认情况下，所有的过滤器都是依次应用的，文件必须通过每一个过滤器。使用 OR 运算符 `.|`，你可以将过滤器组合成 OR 关系，所以文件只有满足其中一个过滤器才能通过过滤器。例如，`.l.ttext<CR>.|`，只会显示符号链接或者 MIME 类型包含 "text" 的文件。你可以在任何时候使用 `..` 来查看你当前的 `filter_stack`。使用 `.c` 来清除 `filter_stack`。

你也可以使用 `o` 来排序文件，然后选择你喜欢的排序方式。

__TIP 1:__ 如果你想按大小排序文件夹，你需要获取它们的内容大小。你可以通过选择所有文件/文件夹(`v` 键)并按下 `dc` 键来获取它们的大小。然后只需按 `os` 来按大小排序文件/文件夹。

__TIP 2:__ 你也可以使用 `dU` 来查看文件夹的列表，按大小排序(从大到小)，这个键绑定调用了 shell 命令 `du`，对它的结果进行排序，并显示给你。

### 扁平化目录

如果你正在浏览一个有很多嵌套目录的目录树，你可能会发现 `:flat N` 很有用。它允许你以线性方式浏览目录树:所有的文件都会显示在一起。这有点难以解释，所以只需调用 `:flat 1` 并观察发生了什么。参数是最大的目录展平数。传递 -1 来禁用限制(谨慎使用!)和 0 来禁用 `:flat`。

## 文件操作

### 复制和移动

要打开一个文件并让 ranger 选择打开它的程序(通过 [`rifle`](#Rifle))，只需按 `Enter` 键。要自己选择，按 `r` 键，然后从列表中选择或者输入你想要使用的程序。你也可以使用 `:open_with` 命令。

要添加一个文件处理程序到 ranger 的库中，运行命令 `ranger --copy-config=rifle`，然后编辑生成的文件。例如，要添加 Kolourpaint 作为图像编辑器，你可以添加:

```
mime ^image, has kolourpaint, X, flag f = kolourpaint -- "$@"
```

这个文件中的语句的顺序反映了程序将被使用和出现在 `r` 列表中的顺序。

要复制一个文件，高亮它，按 `yy` 来标记它为复制(类似于在 vim 中使用 `yy` 复制一行)，然后导航到目标目录(或者切换标签，如果你决定使用 `mc` 的方式)，然后按 `pp` 来粘贴它(几乎像在 vim 中一样)。

(要复制目录，文件名，或者文件路径作为文本到你的剪贴板，你需要安装 [xclip](https://github.com/astrand/xclip)，[xsel](http://www.vergenet.net/~conrad/software/xsel/) 或者 [pbcopy](https://www.unix.com/man-page/all/1/pbcopy/) (在使用 macOS 时)，分别使用 `yd`，`yn` 和 `yp`

移动文件和复制文件的操作几乎没有什么区别: 只需在开始使用 `dd` 而不是 `yy`。

要复制/移动多个文件，只需使用 `Space` 键标记它们，然后使用 `dd`/`yy`。如果你想操作存储在不同目录中的多个文件，你可以使用 `ya`/`da` 将它们添加到要复制/移动的文件列表中，然后再粘贴它们。

(请注意，复制/剪切缓冲区也可以用于其他操作，通过在你的命令中使用 `%c` 宏。例如，使用 `ya`/`da` 添加文件到剪切/复制缓冲区，然后使用 `:shell -w printf %c | xargs rm` 命令允许你删除多个文件和多个目录。记得在使用完后清空缓冲区，使用 `ud`/`uy`。)

如果你想从一个 ranger 实例复制文件到另一个 ranger 实例，在一个实例中输入 `:save_copy_buffer`，在另一个实例中输入 `:load_copy_buffer`。这种方法也可以用于导出文件列表。它们被保存在文件 `~/.config/ranger/copy_buffer` 中。

::: info
`rifle` 是一个强大的智能文件打开器，它与 ranger 捆绑在一起。它试图根据文件的 MIME 类型，扩展名，可用程序和其他一些因素来猜测它应该用什么程序打开给定的文件。它是通过 `rifle.conf` 文件配置的。它在 ranger 内部使用，但也可以作为一个独立的程序使用。
:::

### 重命名

要重命名一个文件，只需高亮它，然后按 `cw` 就像你在 vim 中改变一个单词一样，在屏幕底部会出现 `:rename` 命令，等待新的文件名，输入它然后按 `Enter`。你也可以在重命名时使用 `%s`，例如，如果你只想改变文件的扩展名，你可以使用 `:rename %s.txt`。还有 `I` 和 `A` 键绑定，它们分别在文件名的开始和结尾打开控制台，用于重命名。

ranger 支持使用 `:bulkrename` 命令进行批量文件重命名。标记你想要重命名的文件，然后调用 `:bulkrename`。它应该会在你的文本编辑器中打开一个包含这些文件的列表的文件(使用 `rifle` 确定)，你可以自由地在那个文件中更改文件名。当你完成后，保存文件并关闭编辑器。ranger 将在几秒钟内显示你将要发生的预览。

`:bulkrename` 与 `:flat` 配合使用效果很好!

### 删除和创建

你要删除一个文件，只需高亮它，然后按 `dd`。你可以使用 `:delete` 命令从控制台中删除文件。要创建文件或者目录，使用 `:touch FILENAME` 和 `:mkdir DIRNAME`。

## 使用 shell 和 flags

ranger 允许你使用 shell。只需在 `:shell` 后输入你的 shell 命令，然后按 `Enter` 键运行它。你可以在那里使用标志以某种特殊的方式运行程序/命令(使用 root 权限，后台运行等)。

### Flags

Flags 用于以某种特殊的方式运行外部命令。

- `w` 显示外部命令的输出，比如 `:shell -w free`
- `t` 在新的终端窗口中运行命令，比如 `:shell -t nano`
- `f` 在新的 GUI 程序中运行命令，比如 `:shell -f firefox`
- `r` 以 root 权限运行程序。你可以同时使用多个标志，比如 `:shell -rw apt update`

为了获取更多关于标志的信息，请看 [Ranger Man #FLAGS](https:w/ranger.github.io/ranger.1.html#FLAGS)

## 更多 tips

### 获取帮助

你可以在使用 ranger 时按 `?` 键来获取帮助，然后:

- `m` 打开 ranger 的 `man` 页面
- `k` 打开键位绑定列表
- `c` 打开命令列表
- `s` 打开设置列表

### 元信息

ranger 的元信息功能是一个全新的功能。它可以用来为任何文件添加任意的键值数据。调用 `:meta title a very interesting title` 将当前文件的标签 "title" 设置为 "a very interesting title"。

`:meta` 最常用于与 `:linemode` 结合使用。内置的行模式绑定到 "M" 后面的一些字母。在撰写本指南时，有 6 个内置的行模式:

- `filename`: 没有元数据，ranger 的默认模式，
- `permissions`: 文件权限显示在文件旁边，
- `fileinfo`: 基于 shell `file` 命令显示文件类型信息
- `mtime`: 显示文件的修改时间
- `sizemtime`: 显示文件的大小和修改时间
- `metatitle`: 请参考下面的内容。

`:meta` 将元数据存储在每个使用它的目录中的 `.metadata.json` 文件中。
